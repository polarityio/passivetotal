{{#if errorMessage}}
  <div class='alert alert-danger error-container'>
    <div class='error-title'>{{fa-icon 'exclamation-circle'}} Error Loading Data</div>
    {{errorMessage}}
  </div>
{{/if}}

{{#if
  (or
    details.summary.isConnectionReset
    details.summary.maxRequestQueueLimitHit
    details.summary.isGatewayTimeout
    details.summary.apiKeyLimitReached
  )
}}
  {{#unless details.summary.apiKeyLimitReached}}
    <button type='button' class='btn btn-polarity btn-sm retry-btn' {{action 'retrySearch' 'summary'}}>
      {{#if block._state.searchRunning.summary}}
        {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
      {{else}}
        Retry Search
      {{/if}}
    </button>
    <div class='mt-1'>
      <span>A temporary PassiveTotal API search limit was reached. You can retry your search by pressing the "Retry
        Search" button.</span>
    </div>
  {{/unless}}

  {{#if details.summary.apiKeyLimitReached}}
    <div class='mt-1'>
      <span>You have reached your PassiveTotal API Search Quota. Please view your Search Quota below to determine when
        you will be able to run searches again.</span>
      <div class='mt-1'>
        <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
          PassiveTotal Web Interface
          {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
      </div>
      <div>
        <span class='p-footnote'>Use the link to run this search via the PassiveTotal website which uses a different
          quota.</span>
      </div>
      {{! Get Quota Information }}
      <div class='mt-1'>
        <span class='p-action' {{action 'showQuota'}}>
          {{#if block._state.viewQuota}}
            Hide Search Quota
            {{fa-icon icon='chevron-up'}}
          {{else}}
            View Search Quota
            {{fa-icon icon='chevron-down'}}
          {{/if}}
        </span>
        {{#if block._state.searchRunning.quota}}
          <div class='mt-1'>
            {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
            Loading Quota ...
          </div>
        {{/if}}
        {{#if block._state.viewQuota}}
          {{#if details.quota}}
            <div class='quota-container mt-1'>
              {{#if details.quota.user}}
                <div>
                  <div>
                    <span class='p-title mt-0'>{{fa-icon icon='user' fixedWidth=true}} Your User Search Quota</span>
                  </div>
                  <div>
                    <span class='p-key'>API Searches:</span>
                    <span class='p-value'>{{details.quota.user.licenseCounts.searchApi}}
                      of
                      {{details.quota.user.licenseLimits.searchApi}}
                      used</span>
                  </div>
                  <div>
                    <span class='p-key'>Quota Duration: </span>
                    <span class='p-value'>{{details.quota.user.quotaInterval}}</span>
                  </div>
                  <div>
                    <span class='p-key'>Next Quota Reset: </span>
                    <span class='p-value'>{{details.quota.user.next_reset}}</span>
                  </div>
                </div>
              {{/if}}
              {{#if details.quota.organization}}
                <div class='mt-1'>
                  <div>
                    <span class='p-title'>{{fa-icon icon='building' fixedWidth=true}}
                      Your Organization Search Quota</span>
                  </div>
                  <div>
                    <span class='p-key'>API Searches: </span>
                    <span class='p-value'>{{details.quota.organization.licenseCounts.enterprise.searchApi}}
                      of
                      {{details.quota.organization.licenseLimits.enterprise.searchApi}}
                      used</span>
                  </div>
                  <div>
                    <span class='p-key'>Quota Duration:</span>
                    <span>{{details.quota.organization.quotaInterval}}</span>
                  </div>
                  <div>
                    <span class='p-key'>Next Quota Reset: </span>
                    <span class='p-value'>{{details.quota.organization.next_reset}}</span>
                  </div>
                </div>
              {{/if}}
              <span class='reload-quota-btn' {{action 'getQuota'}}>
                {{fa-icon
                  icon='sync'
                  fixedWidth=true
                  class='icon'
                  title='Refresh Quota'
                  spin=(if block._state.searchRunning.quota true false)
                }}
              </span>
            </div>
          {{/if}}
        {{/if}}
      </div>
    </div>
  {{/if}}
{{else if details}}
  {{#if (not-eq block.entity.type 'custom')}}
    {{! IPv4 and Domain output parsing}}
    <div class='selectContainer pt-1'>
      <span class='p-value'>Options: </span>
      <select class='w-100' onchange={{action 'selectResultType' value='target.value'}}>
        <option value='summary'>Summary</option>
        <option value='services'>Services
          {{#if block._state.searchRunning.services}}{{fa-icon
              'spinner-third'
              fixedWisdth=true
              spin=true
              class='loading-icon'
            }}{{/if}}
          {{#if details.services.servicesData}}
            ({{details.services.servicesData.length}})
          {{/if}}
        </option>
        <option value='osint'>OSINT
          {{#if block._state.searchRunning.malware}}{{fa-icon
              'spinner-third'
              fixedWisdth=true
              spin=true
              class='loading-icon'
            }}{{/if}}
          {{#if details.osint.osintData.length}}
            ({{details.osint.osintData.length}})
          {{/if}}
        </option>
        <option value='pdns'>Resolutions/PDNS
          {{#if block._state.searchRunning.pdns}}{{fa-icon
              'spinner-third'
              fixedWidth=true
              spin=true
              class='loading-icon'
            }}{{/if}}
          {{#if pdnsIsLoaded}}
            ({{details.pdns.length}})
          {{/if}}
        </option>
        <option value='malware'>Malware
          {{#if block._state.searchRunning.malware}}{{fa-icon
              'spinner-third'
              fixedWisdth=true
              spin=true
              class='loading-icon'
            }}{{/if}}
          {{#if malwareIsLoaded}}
            ({{details.malware.length}})
          {{/if}}
        </option>
        <option value='certificates'>SSL Certificates
          {{#if block._state.searchRunning.certificates}}{{fa-icon
              'spinner-third'
              fixedWidth=true
              spin=true
              class='loading-icon'
            }}{{/if}}
          {{#if certificatesIsLoaded}}
            ({{details.certificates.length}})
          {{/if}}
        </option>
        <option value='whois'>WHOIS
          {{#if block._state.searchRunning.whois}}{{fa-icon
              'spinner-third'
              fixedWidth=true
              spin=true
              class='loading-icon'
            }}{{/if}}
          {{#if details.whois.totalRecords}}
            ({{if details.whois.totalRecords details.whois.totalRecords '(1)'}})
          {{/if}}
        </option>
        <option value='articles'>Articles
          {{#if block._state.searchRunning.articles}}{{fa-icon
              'spinner-third'
              fixedWidth=true
              spin=true
              class='loading-icon'
            }}{{/if}}
          {{#if articlesIsLoaded}}
            ({{details.articles.length}})
          {{/if}}
        </option>
        <option value='pairs'>Host Pairs
          {{#if block._state.searchRunning.pairs}}{{fa-icon
              'spinner-third'
              fixedWidth=true
              spin=true
              class='loading-icon'
            }}{{/if}}
          {{#if pairsIsLoaded}}
            ({{details.pairs.length}})
          {{/if}}
        </option>
        <option value='reputation'>Reputations
          {{#if block._state.searchRunning.reputation}}{{fa-icon
              'spinner-third'
              fixedWidth=true
              spin=true
              class='loading-icon'
            }}{{/if}}
          {{#if details.reputation.classification}}
            ({{details.reputation.classification}})
          {{/if}}
        </option>
        <option value='subdomains'>Subdomains
          {{#if block._state.searchRunning.subdomains}}{{fa-icon
              'spinner-third'
              fixedWidth=true
              spin=true
              class='loading-icon'
            }}{{/if}}
          {{#if details.subdomains.name}}
            ({{if details.subdomains.name 'Found' 'Unknown'}})
          {{/if}}
        </option>
      </select>
    </div>

    {{#if (eq currentInfo 'pairs')}}
      {{#if (and block._state.searchRunning.pairs (not block._state.initialLoadAttempted.pairs))}}
        <div class='alert alert-info mt-2' role='alert'>
          {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
          Loading Host Pairs
        </div>
      {{else if (or
        details.pairs.isConnectionReset
        details.pairs.maxRequestQueueLimitHit
        details.pairs.isGatewayTimeout
        details.pairs.apiKeyLimitReached
        details.pairs.onMessageTimeout
      )}}
        {{#unless details.pairs.apiKeyLimitReached}}
          <button type='button' class='btn btn-polarity btn-sm retry-btn mt-1' {{action 'retrySearch' 'pairs'}}>
            {{#if block._state.searchRunning.pairs}}
              {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
            {{else}}
              Retry Pairs Search
            {{/if}}
          </button>
        {{/unless}}
        <div class='mt-1'>
          {{#if details.pairs.onMessageTimeout}}
            <span>The PassiveTotal API took too long to respond. You can retry your search by pressing the "Retry Pairs
              Search" button.</span>
            <div class='mt-1'>
              <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
                PassiveTotal Web Interface
                {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
            </div>
            <div>
              <span class='p-footnote'>Some searches via the PassiveTotal API take too long to respond. Click the link
                to run the search via the PassiveTotal website instead.</span>
            </div>
          {{else if details.pairs.apiKeyLimitReached}}
            <span>{{fa-icon icon='exclamation-circle' fixedWidth=true class='details-icon'}}
              You have reached your PassiveTotal API Search Quota. Please view your Search Quota below to determine when
              you will be able to run searches again.</span>
            <div class='mt-1'>
              <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
                PassiveTotal Web Interface
                {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
            </div>
            <div>
              <span class='p-footnote'>Use the link to run this search via the PassiveTotal website which uses a
                different quota.</span>
            </div>
            {{#if details.quota.user}}
              <div class='mt-1'>
                <div>
                  <span class='p-title'>{{fa-icon icon='user' fixedWidth=true}} Your User Search Quota</span>
                </div>
                <div>
                  <span class='p-key'>API Searches:</span>
                  <span class='p-value'>{{details.quota.user.licenseCounts.searchApi}}
                    of
                    {{details.quota.user.licenseLimits.searchApi}}
                    used</span>
                </div>
                <div>
                  <span class='p-key'>Quota Duration: </span>
                  <span class='p-value'>{{details.quota.user.quotaInterval}}</span>
                </div>
                <div>
                  <span class='p-key'>Next Quota Reset: </span>
                  <span class='p-value'>{{details.quota.user.next_reset}}</span>
                </div>
              </div>
            {{/if}}
            {{#if details.quota.organization}}
              <div class='mt-1'>
                <div>
                  <span class='p-title mt-0'>{{fa-icon icon='building' fixedWidth=true}}
                    Your Organization Search Quota</span>
                </div>
                <div>
                  <span class='p-key'>API Searches: </span>
                  <span class='p-value'>{{details.quota.organization.licenseCounts.enterprise.searchApi}}
                    of
                    {{details.quota.organization.licenseLimits.enterprise.searchApi}}
                    used</span>
                </div>
                <div>
                  <span class='p-key'>Quota Duration:</span>
                  <span>{{details.quota.organization.quotaInterval}}</span>
                </div>
                <div>
                  <span class='p-key'>Next Quota Reset: </span>
                  <span class='p-value'>{{details.quota.organization.next_reset}}</span>
                </div>
              </div>
            {{/if}}
          {{else}}
            <div class='mt-1'>
              <span>A temporary PassiveTotal API search limit was reached. You can retry your search by pressing the
                "Retry Pairs Search" button.</span>
            </div>
          {{/if}}
        </div>
      {{else}}
        {{#if details.pairs.length}}
          <h1 class='p-title'>
            {{fa-icon 'handshake' fixedWidth=true}}
            Host Pairs Details
          </h1>
          {{#each details.pairs as |pair index|}}
            {{#if (gt index 0)}}
              <hr />
            {{/if}}
            <div class='mb-2'>
              {{#if pair.parent}}
                <div>
                  <span class='p-key'>Parent: </span>
                  <span class='p-value'>{{pair.parent}}</span>
                </div>
              {{/if}}
              {{#if pair.child}}
                <div>
                  <span class='p-key'>Child: </span>
                  <span class='p-value'>{{pair.child}}</span>
                </div>
              {{/if}}
              {{#if pair.cause}}
                <div>
                  <span class='p-key'>Cause: </span>
                  <span class='p-value'>{{pair.cause}}</span>
                </div>
              {{/if}}
              {{#if pair.firstSeen}}
                <div>
                  <span class='p-key'>First Seen: </span>
                  <span class='p-value'>{{pair.firstSeen}}</span>
                </div>
              {{/if}}
              {{#if pair.lastSeen}}
                <div>
                  <span class='p-key'>Last Seen: </span>
                  <span class='p-value'>{{pair.lastSeen}}</span>
                </div>
              {{/if}}
            </div>
          {{/each}}
        {{else}}
          <div class='alert alert-info mt-2' role='alert'>
            No Host Pairs Details Found
          </div>
        {{/if}}
      {{/if}}
    {{/if}}

    {{#if (eq currentInfo 'pdns')}}
      {{#if (and block._state.searchRunning.pdns (not block._state.initialLoadAttempted.pdns))}}
        <div class='alert alert-info mt-2' role='alert'>
          {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
          Loading Resolution/PDNS
        </div>
      {{else if (or
        details.pdns.isConnectionReset
        details.pdns.maxRequestQueueLimitHit
        details.pdns.isGatewayTimeout
        details.pdns.apiKeyLimitReached
        details.pdns.onMessageTimeout
      )}}
        {{#unless details.pdns.apiKeyLimitReached}}
          <button type='button' class='btn btn-polarity btn-sm retry-btn mt-1' {{action 'retrySearch' 'pdns'}}>
            {{#if block._state.searchRunning.pdns}}
              {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
            {{else}}
              Retry PDNS Search
            {{/if}}
          </button>
        {{/unless}}
        <div class='mt-1'>
          {{#if details.pdns.onMessageTimeout}}
            <span>The PassiveTotal API took too long to respond. You can retry your search by pressing the "Retry PDNS
              Search" button.</span>
            <div class='mt-1'>
              <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
                PassiveTotal Web Interface
                {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
            </div>
            <div>
              <span class='p-footnote'>Some searches via the PassiveTotal API take too long to respond. Click the link
                to run the search via the PassiveTotal website instead.</span>
            </div>
          {{else if details.pdns.apiKeyLimitReached}}
            <span>{{fa-icon icon='exclamation-circle' fixedWidth=true class='details-icon'}}
              You have reached your PassiveTotal API Search Quota. Please view your Search Quota below to determine when
              you will be able to run searches again.</span>
            <div class='mt-1'>
              <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
                PassiveTotal Web Interface
                {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
            </div>
            <div>
              <span class='p-footnote'>Use the link to run this search via the PassiveTotal website which uses a
                different quota.</span>
            </div>
            {{#if details.quota.user}}
              <div class='mt-1'>
                <div>
                  <span class='p-title'>{{fa-icon icon='user' fixedWidth=true}} Your User Search Quota</span>
                </div>
                <div>
                  <span class='p-key'>API Searches:</span>
                  <span class='p-value'>{{details.quota.user.licenseCounts.searchApi}}
                    of
                    {{details.quota.user.licenseLimits.searchApi}}
                    used</span>
                </div>
                <div>
                  <span class='p-key'>Quota Duration: </span>
                  <span class='p-value'>{{details.quota.user.quotaInterval}}</span>
                </div>
                <div>
                  <span class='p-key'>Next Quota Reset: </span>
                  <span class='p-value'>{{details.quota.user.next_reset}}</span>
                </div>
              </div>
            {{/if}}
            {{#if details.quota.organization}}
              <div class='mt-1'>
                <div>
                  <span class='p-title mt-0'>{{fa-icon icon='building' fixedWidth=true}}
                    Your Organization Search Quota</span>
                </div>
                <div>
                  <span class='p-key'>API Searches: </span>
                  <span class='p-value'>{{details.quota.organization.licenseCounts.enterprise.searchApi}}
                    of
                    {{details.quota.organization.licenseLimits.enterprise.searchApi}}
                    used</span>
                </div>
                <div>
                  <span class='p-key'>Quota Duration:</span>
                  <span>{{details.quota.organization.quotaInterval}}</span>
                </div>
                <div>
                  <span class='p-key'>Next Quota Reset: </span>
                  <span class='p-value'>{{details.quota.organization.next_reset}}</span>
                </div>
              </div>
            {{/if}}
          {{else}}
            <div class='mt-1'>
              <span>A temporary PassiveTotal API search limit was reached. You can retry your search by pressing the
                "Retry PDNS Search" button.</span>
            </div>
          {{/if}}
        </div>
      {{else}}
        {{#if details.pdns.length}}
          <h1 class='p-title'>
            {{fa-icon 'ethernet' fixedWidth=true}}
            <span>Resolutions/PDNS Details </span>
          </h1>
          {{#each details.pdns as |pdns index|}}
            {{#if (gt index 0)}}
              <hr />
            {{/if}}
            <div class='mb-2'>
              {{#if pdns.value}}
                <div>
                  <h1 class='p-title'>
                    {{pdns.value}}
                  </h1>
                </div>
              {{/if}}

              {{#if pdns.resolve}}
                <div>
                  <span class='p-key'>Resolve: </span>
                  <span class='p-value'>{{pdns.resolve}}</span>
                </div>
              {{/if}}
              {{#if pdns.recordType}}
                <div>
                  <span class='p-key'>Record Type: </span>
                  <span class='p-value'>{{pdns.recordType}}</span>
                </div>
              {{/if}}
              {{#if pdns.resolveType}}
                <div>
                  <span class='p-key'>Resolve Type: </span>
                  <span class='p-value'>{{pdns.resolveType}}</span>
                </div>
              {{/if}}
              {{#if pdns.recordHash}}
                <div>
                  <span class='p-key'>Record Hash: </span>
                  <span class='p-value'>{{pdns.recordHash}}</span>
                </div>
              {{/if}}
              {{#if pdns.source.length}}
                <div>
                  <span class='p-key'>Sources: </span>
                  <div class='p-value'>
                    {{#each pdns.source as |source|}}
                      <span class='tag'>{{source}}</span>
                    {{/each}}
                  </div>
                </div>
              {{/if}}
              {{#if pdns.collected}}
                <div>
                  <span class='p-key'>Collected: </span>
                  <span class='p-value'>{{pdns.collected}}</span>
                </div>
              {{/if}}
              {{#if pdns.firstSeen}}
                <div>
                  <span class='p-key'>First Seen: </span>
                  <span class='p-value'>{{pdns.firstSeen}}</span>
                </div>
              {{/if}}
              {{#if pdns.lastSeen}}
                <div>
                  <span class='p-key'>Last Seen: </span>
                  <span class='p-value'>{{pdns.lastSeen}}</span>
                </div>
              {{/if}}
            </div>
          {{/each}}
        {{else}}
          <div class='alert alert-info mt-2' role='alert'>
            No Resolutions/PDNS Details Found
          </div>
        {{/if}}
      {{/if}}
    {{/if}}

    {{#if (eq currentInfo 'whois')}}
      {{#if (and block._state.searchRunning.whois (not block._state.initialLoadAttempted.whois))}}
        <div class='alert alert-info mt-2' role='alert'>
          {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
          Loading WHOIS
        </div>
      {{else if (or
        details.whois.isConnectionReset
        details.whois.maxRequestQueueLimitHit
        details.whois.isGatewayTimeout
        details.whois.apiKeyLimitReached
        details.whois.onMessageTimeout
      )}}
        {{#unless details.whois.apiKeyLimitReached}}
          <button type='button' class='btn btn-polarity btn-sm retry-btn mt-1' {{action 'retrySearch' 'whois'}}>
            {{#if block._state.searchRunning.whois}}
              {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
            {{else}}
              Retry WHOIS Search
            {{/if}}
          </button>
        {{/unless}}
        <div class='mt-1'>
          {{#if details.whois.onMessageTimeout}}
            <span>The PassiveTotal API took too long to respond. You can retry your search by pressing the "Retry WHOIS
              Search" button.</span>
            <div class='mt-1'>
              <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
                PassiveTotal Web Interface
                {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
            </div>
            <div>
              <span class='p-footnote'>Some searches via the PassiveTotal API take too long to respond. Click the link
                to run the search via the PassiveTotal website instead.</span>
            </div>
          {{else if details.whois.apiKeyLimitReached}}
            <span>{{fa-icon icon='exclamation-circle' fixedWidth=true class='details-icon'}}
              You have reached your PassiveTotal API Search Quota. Please view your Search Quota below to determine when
              you will be able to run searches again.</span>
            <div class='mt-1'>
              <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
                PassiveTotal Web Interface
                {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
            </div>
            <div>
              <span class='p-footnote'>Use the link to run this search via the PassiveTotal website which uses a
                different quota.</span>
            </div>
            {{#if details.quota.user}}
              <div class='mt-1'>
                <div>
                  <span class='p-title'>{{fa-icon icon='user' fixedWidth=true}} Your User Search Quota</span>
                </div>
                <div>
                  <span class='p-key'>API Searches:</span>
                  <span class='p-value'>{{details.quota.user.licenseCounts.searchApi}}
                    of
                    {{details.quota.user.licenseLimits.searchApi}}
                    used</span>
                </div>
                <div>
                  <span class='p-key'>Quota Duration: </span>
                  <span class='p-value'>{{details.quota.user.quotaInterval}}</span>
                </div>
                <div>
                  <span class='p-key'>Next Quota Reset: </span>
                  <span class='p-value'>{{details.quota.user.next_reset}}</span>
                </div>
              </div>
            {{/if}}
            {{#if details.quota.organization}}
              <div class='mt-1'>
                <div>
                  <span class='p-title mt-0'>{{fa-icon icon='building' fixedWidth=true}}
                    Your Organization Search Quota</span>
                </div>
                <div>
                  <span class='p-key'>API Searches: </span>
                  <span class='p-value'>{{details.quota.organization.licenseCounts.enterprise.searchApi}}
                    of
                    {{details.quota.organization.licenseLimits.enterprise.searchApi}}
                    used</span>
                </div>
                <div>
                  <span class='p-key'>Quota Duration:</span>
                  <span>{{details.quota.organization.quotaInterval}}</span>
                </div>
                <div>
                  <span class='p-key'>Next Quota Reset: </span>
                  <span class='p-value'>{{details.quota.organization.next_reset}}</span>
                </div>
              </div>
            {{/if}}
          {{else}}
            <div class='mt-1'>
              <span>A temporary PassiveTotal API search limit was reached. You can retry your search by pressing the
                "Retry WHOIS Search" button.</span>
            </div>
          {{/if}}
        </div>
      {{else}}

        {{#if details.whois}}
          {{#each details.whois.whoisData as |detail|}}
            <hr />
            <h1 class='p-title'>
              {{fa-icon 'search' fixedWidth=true}}
              <strong>WHOIS Details</strong>
            </h1>
            <div class='mb-2'>
              {{#if detail.whoisServer}}
                <div>
                  <span class='p-key'>WHOIS Server: </span>
                  <span class='p-value'>{{details.whois.whoisServer}}</span>
                </div>
              {{/if}}
              {{#if detail.domain}}
                <div>
                  <span class='p-key'>Domain: </span>
                  <span class='p-value'>{{detail.domain}}</span>
                </div>
              {{/if}}
              {{#if detail.domainStatus}}
                <div>
                  <span class='p-key'>Domain Status: </span>
                  <span class='p-value'>{{detail.domainStatus}}</span>
                </div>
              {{/if}}
              {{#if detail.name}}
                <div>
                  <span class='p-key'>Name: </span>
                  <span class='p-value'>{{detail.name}}</span>
                </div>
              {{/if}}
              {{#if detail.organization}}
                <div>
                  <span class='p-key'>Organization: </span>
                  <span class='p-value'>{{detail.organization}}</span>
                </div>
              {{/if}}
              {{#if detail.telephone}}
                <div>
                  <span class='p-key'>Telephone: </span>
                  <span class='p-value'>{{detail.telephone}}</span>
                </div>
              {{/if}}
              {{#if detail.contactEmail}}
                <div>
                  <span class='p-key'>Contact Email: </span>
                  <span class='p-value'>{{detail.contactEmail}}</span>
                </div>
              {{/if}}
              {{#if detail.nameServers.length}}
                <div>
                  <span class='p-key'>Name Servers: </span>
                  <div class='p-value'>
                    {{#each detail.nameServers as |nameServer|}}
                      <span class='tag'>{{nameServer}}</span>
                    {{/each}}
                  </div>
                </div>
              {{/if}}
              {{#if detail.registrar}}
                <div>
                  <span class='p-key'>Registrar: </span>
                  <span class='p-value'>{{detail.registrar}}</span>
                </div>
              {{/if}}
              {{#if detail.expiresAt}}
                <div>
                  <span class='p-key'>Expires At: </span>
                  <span class='p-value'>{{moment-format
                      detail.expiresAt
                      'MM/DD/YYYY HH:mm:ss'
                      timeZone=timezone
                    }}</span>
                </div>
              {{/if}}
              {{#if detail.lastLoadedAt}}
                <div>
                  <span class='p-key'>Last Loaded At: </span>
                  <span class='p-value'>{{moment-format
                      detail.lastLoadedAt
                      'MM/DD/YYYY HH:mm:ss'
                      timeZone=timezone
                    }}</span>
                </div>
              {{/if}}
              {{#if detail.registered}}
                <div>
                  <span class='p-key'>Registered: </span>
                  <span class='p-value'>{{moment-format
                      detail.registered
                      'MM/DD/YYYY HH:mm:ss'
                      timeZone=timezone
                    }}</span>
                </div>
              {{/if}}
              {{#if detail.registryUpdatedAt}}
                <div>
                  <span class='p-key'>Registry Updated At: </span>
                  <span class='p-value'>{{moment-format
                      detail.registryUpdatedAt
                      'MM/DD/YYYY HH:mm:ss'
                      timeZone=timezone
                    }}</span>
                </div>
              {{/if}}
            </div>

            {{#if detail.admin.name}}
              <h1 class='p-title'>
                {{fa-icon icon='user-cog' fixedWidth=true}}
                Admin
              </h1>
              <div class='mb-2'>
                {{#if detail.admin.name}}
                  <div>
                    <span class='p-key'>Name: </span>
                    <span class='p-value'>{{detail.admin.name}}</span>
                  </div>
                {{/if}}
                {{#if detail.admin.organization}}
                  <div>
                    <span class='p-key'>Organization: </span>
                    <span class='p-value'>{{detail.admin.organization}}</span>
                  </div>
                {{/if}}
                {{#if detail.admin.email}}
                  <div>
                    <span class='p-key'>Email: </span>
                    <span class='p-value'>{{detail.admin.email}}</span>
                  </div>
                {{/if}}
                {{#if detail.admin.telephone}}
                  <div>
                    <span class='p-key'>Telephone: </span>
                    <span class='p-value'>{{detail.admin.telephone}}</span>
                  </div>
                {{/if}}
                {{#if detail.admin.street}}
                  <div>
                    <span class='p-key'>Street: </span>
                    <span class='p-value'>{{detail.admin.street}}</span>
                  </div>
                {{/if}}
                {{#if detail.admin.postalCode}}
                  <div>
                    <span class='p-key'>Postal Code: </span>
                    <span class='p-value'>{{detail.admin.postalCode}}</span>
                  </div>
                {{/if}}
                {{#if detail.admin.city}}
                  <div>
                    <span class='p-key'>City: </span>
                    <span class='p-value'>{{detail.admin.city}}</span>
                  </div>
                {{/if}}
                {{#if detail.admin.state}}
                  <div>
                    <span class='p-key'>State: </span>
                    <span class='p-value'>{{detail.admin.state}}</span>
                  </div>
                {{/if}}
                {{#if detail.admin.country}}
                  <div>
                    <span class='p-key'>Country: </span>
                    <span class='p-value'>{{detail.admin.country}}</span>
                  </div>
                {{/if}}
              </div>
            {{/if}}

            {{#if detail.registrant.name}}
              <h1 class='p-title'>
                {{fa-icon icon='user-tie' fixedWidth=true}}
                Registrant
              </h1>
              <div class='mb-2'>
                {{#if detail.registrant.name}}
                  <div>
                    <span class='p-key'>Name: </span>
                    <span class='p-value'>{{detail.registrant.name}}</span>
                  </div>
                {{/if}}
                {{#if detail.registrant.organization}}
                  <div>
                    <span class='p-key'>Organization: </span>
                    <span class='p-value'>{{detail.registrant.organization}}</span>
                  </div>
                {{/if}}
                {{#if detail.registrant.email}}
                  <div>
                    <span class='p-key'>Email: </span>
                    <span class='p-value'>{{detail.registrant.email}}</span>
                  </div>
                {{/if}}
                {{#if detail.registrant.telephone}}
                  <div>
                    <span class='p-key'>Telephone: </span>
                    <span class='p-value'>{{detail.registrant.telephone}}</span>
                  </div>
                {{/if}}
                {{#if detail.registrant.street}}
                  <div>
                    <span class='p-key'>Street: </span>
                    <span class='p-value'>{{detail.registrant.street}}</span>
                  </div>
                {{/if}}
                {{#if detail.registrant.postalCode}}
                  <div>
                    <span class='p-key'>Postal Code: </span>
                    <span class='p-value'>{{detail.registrant.postalCode}}</span>
                  </div>
                {{/if}}
                {{#if detail.registrant.city}}
                  <div>
                    <span class='p-key'>City: </span>
                    <span class='p-value'>{{detail.registrant.city}}</span>
                  </div>
                {{/if}}
                {{#if detail.registrant.state}}
                  <div>
                    <span class='p-key'>State: </span>
                    <span class='p-value'>{{detail.registrant.state}}</span>
                  </div>
                {{/if}}
                {{#if detail.registrant.country}}
                  <div>
                    <span class='p-key'>Country: </span>
                    <span class='p-value'>{{detail.registrant.country}}</span>
                  </div>
                {{/if}}
              </div>
            {{/if}}

            {{#if detail.tech.name}}
              <h1 class='p-title'>
                {{fa-icon icon='user-visor' fixedWidth=true}}
                Tech
              </h1>
              <div class='mb-2'>
                {{#if detail.tech.name}}
                  <div>
                    <span class='p-key'>Name: </span>
                    <span class='p-value'>{{detail.tech.name}}</span>
                  </div>
                {{/if}}
                {{#if detail.tech.organization}}
                  <div>
                    <span class='p-key'>Organization: </span>
                    <span class='p-value'>{{detail.tech.organization}}</span>
                  </div>
                {{/if}}
                {{#if detail.tech.email}}
                  <div>
                    <span class='p-key'>Email: </span>
                    <span class='p-value'>{{detail.tech.email}}</span>
                  </div>
                {{/if}}
                {{#if detail.tech.telephone}}
                  <div>
                    <span class='p-key'>Telephone: </span>
                    <span class='p-value'>{{detail.tech.telephone}}</span>
                  </div>
                {{/if}}
                {{#if detail.tech.street}}
                  <div>
                    <span class='p-key'>Street: </span>
                    <span class='p-value'>{{detail.tech.street}}</span>
                  </div>
                {{/if}}
                {{#if detail.tech.postalCode}}
                  <div>
                    <span class='p-key'>Postal Code: </span>
                    <span class='p-value'>{{detail.tech.postalCode}}</span>
                  </div>
                {{/if}}
                {{#if detail.tech.city}}
                  <div>
                    <span class='p-key'>City: </span>
                    <span class='p-value'>{{detail.tech.city}}</span>
                  </div>
                {{/if}}
                {{#if detail.tech.state}}
                  <div>
                    <span class='p-key'>State: </span>
                    <span class='p-value'>{{detail.tech.state}}</span>
                  </div>
                {{/if}}
                {{#if detail.tech.country}}
                  <div>
                    <span class='p-key'>Country: </span>
                    <span class='p-value'>{{detail.tech.country}}</span>
                  </div>
                {{/if}}
              </div>
            {{/if}}
          {{/each}}
        {{else}}
          <div class='alert alert-info mt-2' role='alert'>
            No WHOIS Details Found
          </div>
        {{/if}}
      {{/if}}
    {{/if}}

    {{#if (eq currentInfo 'articles')}}
      {{#if (and block._state.searchRunning.articles (not block._state.initialLoadAttempted.articles))}}
        <div class='alert alert-info mt-2' role='alert'>
          {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
          Loading Articles
        </div>
      {{else if (or
        details.articles.isConnectionReset
        details.articles.maxRequestQueueLimitHit
        details.articles.isGatewayTimeout
        details.articles.apiKeyLimitReached
        details.articles.onMessageTimeout
      )}}
        {{#unless details.articles.apiKeyLimitReached}}
          <button type='button' class='btn btn-polarity btn-sm retry-btn mt-1' {{action 'retrySearch' 'articles'}}>
            {{#if block._state.searchRunning.articles}}
              {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
            {{else}}
              Retry Articles Search
            {{/if}}
          </button>
        {{/unless}}
        <div class='mt-1'>
          {{#if details.articles.onMessageTimeout}}
            <span>The PassiveTotal API took too long to respond. You can retry your search by pressing the "Retry
              Articles Search" button.</span>
            <div class='mt-1'>
              <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
                PassiveTotal Web Interface
                {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
            </div>
            <div>
              <span class='p-footnote'>Some searches via the PassiveTotal API take too long to respond. Click the link
                to run the search via the PassiveTotal website instead.</span>
            </div>
          {{else if details.articles.apiKeyLimitReached}}
            <span>{{fa-icon icon='exclamation-circle' fixedWidth=true class='details-icon'}}
              You have reached your PassiveTotal API Search Quota. Please view your Search Quota below to determine when
              you will be able to run searches again.</span>
            <div class='mt-1'>
              <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
                PassiveTotal Web Interface
                {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
            </div>
            <div>
              <span class='p-footnote'>Use the link to run this search via the PassiveTotal website which uses a
                different quota.</span>
            </div>
            {{#if details.quota.user}}
              <div class='mt-1'>
                <div>
                  <span class='p-title'>{{fa-icon icon='user' fixedWidth=true}} Your User Search Quota</span>
                </div>
                <div>
                  <span class='p-key'>API Searches:</span>
                  <span class='p-value'>{{details.quota.user.licenseCounts.searchApi}}
                    of
                    {{details.quota.user.licenseLimits.searchApi}}
                    used</span>
                </div>
                <div>
                  <span class='p-key'>Quota Duration: </span>
                  <span class='p-value'>{{details.quota.user.quotaInterval}}</span>
                </div>
                <div>
                  <span class='p-key'>Next Quota Reset: </span>
                  <span class='p-value'>{{details.quota.user.next_reset}}</span>
                </div>
              </div>
            {{/if}}
            {{#if details.quota.organization}}
              <div class='mt-1'>
                <div>
                  <span class='p-title mt-0'>{{fa-icon icon='building' fixedWidth=true}}
                    Your Organization Search Quota</span>
                </div>
                <div>
                  <span class='p-key'>API Searches: </span>
                  <span class='p-value'>{{details.quota.organization.licenseCounts.enterprise.searchApi}}
                    of
                    {{details.quota.organization.licenseLimits.enterprise.searchApi}}
                    used</span>
                </div>
                <div>
                  <span class='p-key'>Quota Duration:</span>
                  <span>{{details.quota.organization.quotaInterval}}</span>
                </div>
                <div>
                  <span class='p-key'>Next Quota Reset: </span>
                  <span class='p-value'>{{details.quota.organization.next_reset}}</span>
                </div>
              </div>
            {{/if}}
          {{else}}
            <div class='mt-1'>
              <span>A temporary PassiveTotal API search limit was reached. You can retry your search by pressing the
                "Retry Articles Search" button.</span>
            </div>
          {{/if}}
        </div>
      {{else}}
        {{#if details.articles.length}}
          <h1 class='p-title'>
            {{fa-icon 'newspaper' fixedWidth=true}}
            Article Indicator Details
          </h1>
          {{#each details.articles as |article index|}}
            {{#if (gt index 0)}}
              <hr />
            {{/if}}
            <div class='mb-2'>
              <h1 class='p-title'>
                {{article.title}}
              </h1>
              {{#if article.summary}}
                <div>
                  <span class='p-key'>Summary: </span>
                  <div class='summary'>
                    <span class='p-value summary'>{{article.summary}}</span>
                  </div>
                </div>
              {{/if}}
              {{#if article.type}}
                <div>
                  <span class='p-key'>Type: </span>
                  <span class='p-value'>{{capitalize article.type}}</span>
                </div>
              {{/if}}
              {{#if article.publishedDate}}
                <div>
                  <span class='p-key'>Published Date: </span>
                  <span class='p-value'>{{moment-format
                      article.publishedDate
                      'MM/DD/YYYY HH:mm:ss'
                      timeZone=timezone
                    }}</span>
                </div>
              {{/if}}
              {{#if article.link}}
                <div>
                  <span class='p-key'>Link: </span>
                  <span class='p-value'>
                    <a href={{article.link}}>View Full Article
                      {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
                  </span>
                </div>
              {{/if}}
              {{#if article.categories}}
                <div>
                  <span class='p-key'>Categories: </span>
                  <span class='p-value'>{{article.categories}}</span>
                </div>
              {{/if}}
              {{#if article.tags.length}}
                <div>
                  <span class='p-key'>Tags: </span>
                  <div class='p-value'>
                    {{#each article.tags as |tag|}}
                      <span class='tag'>{{tag}}</span>
                    {{/each}}
                  </div>
                </div>
              {{/if}}
            </div>
          {{/each}}
          <span class='p-footnote mt-2'>This tab only displays articles where the entity
            <b>{{block.entity.value}}</b>
            is listed as an indicator.</span>
        {{else}}
          <div class='alert alert-info mt-2' role='alert'>
            No Articles Found
          </div>
          <div>
            <span class='p-footnote mt-2'>This tab only displays articles where the entity
              <b>{{block.entity.value}}</b>
              is listed as an indicator.</span>
          </div>
        {{/if}}
      {{/if}}
    {{/if}}

    {{#if (eq currentInfo 'certificates')}}
      {{#if (and block._state.searchRunning.certificates (not block._state.initialLoadAttempted.certificates))}}
        <div class='alert alert-info mt-2' role='alert'>
          {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
          Loading SSL Certificates
        </div>
      {{else if (or
        details.certificates.isConnectionReset
        details.certificates.maxRequestQueueLimitHit
        details.certificates.isGatewayTimeout
        details.certificates.apiKeyLimitReached
        details.certificates.onMessageTimeout
      )}}
        {{#unless details.certificates.apiKeyLimitReached}}
          <button type='button' class='btn btn-polarity btn-sm retry-btn mt-1' {{action 'retrySearch' 'certificates'}}>
            {{#if block._state.searchRunning.certificates}}
              {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
            {{else}}
              Retry Certificates Search
            {{/if}}
          </button>
        {{/unless}}
        <div class='mt-1'>
          {{#if details.certificates.onMessageTimeout}}
            <span>The PassiveTotal API took too long to respond. You can retry your search by pressing the "Retry
              Certificates Search" button.</span>
            <div class='mt-1'>
              <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
                PassiveTotal Web Interface
                {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
            </div>
            <div>
              <span class='p-footnote'>Some searches via the PassiveTotal API take too long to respond. Click the link
                to run the search via the PassiveTotal website instead.</span>
            </div>
          {{else if details.certificates.apiKeyLimitReached}}
            <span>{{fa-icon icon='exclamation-circle' fixedWidth=true class='details-icon'}}
              You have reached your PassiveTotal API Search Quota. Please view your Search Quota below to determine when
              you will be able to run searches again.</span>
            <div class='mt-1'>
              <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
                PassiveTotal Web Interface
                {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
            </div>
            <div>
              <span class='p-footnote'>Use the link to run this search via the PassiveTotal website which uses a
                different quota.</span>
            </div>
            {{#if details.quota.user}}
              <div class='mt-1'>
                <div>
                  <span class='p-title'>{{fa-icon icon='user' fixedWidth=true}} Your User Search Quota</span>
                </div>
                <div>
                  <span class='p-key'>API Searches:</span>
                  <span class='p-value'>{{details.quota.user.licenseCounts.searchApi}}
                    of
                    {{details.quota.user.licenseLimits.searchApi}}
                    used</span>
                </div>
                <div>
                  <span class='p-key'>Quota Duration: </span>
                  <span class='p-value'>{{details.quota.user.quotaInterval}}</span>
                </div>
                <div>
                  <span class='p-key'>Next Quota Reset: </span>
                  <span class='p-value'>{{details.quota.user.next_reset}}</span>
                </div>
              </div>
            {{/if}}
            {{#if details.quota.organization}}
              <div class='mt-1'>
                <div>
                  <span class='p-title mt-0'>{{fa-icon icon='building' fixedWidth=true}}
                    Your Organization Search Quota</span>
                </div>
                <div>
                  <span class='p-key'>API Searches: </span>
                  <span class='p-value'>{{details.quota.organization.licenseCounts.enterprise.searchApi}}
                    of
                    {{details.quota.organization.licenseLimits.enterprise.searchApi}}
                    used</span>
                </div>
                <div>
                  <span class='p-key'>Quota Duration:</span>
                  <span>{{details.quota.organization.quotaInterval}}</span>
                </div>
                <div>
                  <span class='p-key'>Next Quota Reset: </span>
                  <span class='p-value'>{{details.quota.organization.next_reset}}</span>
                </div>
              </div>
            {{/if}}
          {{else}}
            <div class='mt-1'>
              <span>A temporary PassiveTotal API search limit was reached. You can retry your search by pressing the
                "Retry Certificates Search" button.</span>
            </div>
          {{/if}}
        </div>
      {{else}}
        {{#if details.certificates.length}}
          <h1 class='p-title'>
            {{fa-icon 'certificate' fixedWidth=true}}
            SSL Certificates Details
          </h1>
          {{#each details.certificates as |certificate index|}}
            {{#if (gt index 0)}}
              <hr />
            {{/if}}
            <div class='mb-2'>
              <h1 class='p-title'>
                Certification Info
              </h1>
              {{#if certificate.sslVersion}}
                <div>
                  <span class='p-key'>SSL Version: </span>
                  <span class='p-value'>{{certificate.sslVersion}}</span>
                </div>
              {{/if}}
              {{#if certificate.fingerprint}}
                <div>
                  <span class='p-key'>Fingerprint: </span>
                  <span class='p-value'>{{certificate.fingerprint}}</span>
                </div>
              {{/if}}
              {{#if certificate.sha1}}
                <div>
                  <span class='p-key'>SHA1: </span>
                  <span class='p-value'>{{certificate.sha1}}</span>
                </div>
              {{/if}}
              {{#if certificate.serialNumber}}
                <div>
                  <span class='p-key'>Serial Number: </span>
                  <span class='p-value'>{{certificate.serialNumber}}</span>
                </div>
              {{/if}}
              {{#if certificate.expirationDate}}
                <div>
                  <span class='p-key'>Expiration Date: </span>
                  <span class='p-value'>{{moment-format
                      certificate.expirationDate
                      'MM/DD/YYYY HH:mm:ss'
                      timeZone=timezone
                    }}</span>
                </div>
              {{/if}}
              {{#if certificate.issueDate}}
                <div>
                  <span class='p-key'>Issue Date: </span>
                  <span class='p-value'>{{moment-format
                      certificate.issueDate
                      'MM/DD/YYYY HH:mm:ss'
                      timeZone=timezone
                    }}</span>
                </div>
              {{/if}}
              {{#if certificate.firstSeen}}
                <div>
                  <span class='p-key'>First Seen: </span>
                  <span class='p-value'>{{moment-format
                      certificate.firstSeen
                      'MM/DD/YYYY HH:mm:ss'
                      timeZone=timezone
                    }}</span>
                </div>
              {{/if}}
              {{#if certificate.lastSeen}}
                <div>
                  <span class='p-key'>Last Seen: </span>
                  <span class='p-value'>{{moment-format
                      certificate.lastSeen
                      'MM/DD/YYYY HH:mm:ss'
                      timeZone=timezone
                    }}</span>
                </div>
              {{/if}}
            </div>
            <div class='mb-2'>
              <h1 class='p-title'>
                Subject Cert Info
              </h1>
              {{#if certificate.subjectCommonName}}
                <div>
                  <span class='p-key'>Subject Common Name: </span>
                  <span class='p-value'>{{certificate.subjectCommonName}}</span>
                </div>
              {{/if}}
              {{#if certificate.subjectGivenName}}
                <div>
                  <span class='p-key'>Subject Given Name: </span>
                  <span class='p-value'>{{certificate.subjectGivenName}}</span>
                </div>
              {{/if}}
              {{#if certificate.subjectSurname}}
                <div>
                  <span class='p-key'>Subject Surname: </span>
                  <span class='p-value'>{{certificate.subjectSurname}}</span>
                </div>
              {{/if}}
              {{#if certificate.subjectAlternativeNames.length}}
                <div>
                  <span class='p-key'>Subject Alternative Names: </span>
                  <span class='p-value'>{{join ', ' certificate.subjectAlternativeNames}}</span>
                </div>
              {{/if}}
              {{#if certificate.subjectLocalityName}}
                <div>
                  <span class='p-key'>Subject Locality Name: </span>
                  <span class='p-value'>{{certificate.subjectLocalityName}}</span>
                </div>
              {{/if}}
              {{#if certificate.subjectOrganizationName}}
                <div>
                  <span class='p-key'>Subject Organization Name: </span>
                  <span class='p-value'>{{certificate.subjectOrganizationName}}</span>
                </div>
              {{/if}}
              {{#if certificate.subjectOrganizationUnitName}}
                <div>
                  <span class='p-key'>Subject Organization Unit Name: </span>
                  <span class='p-value'>{{certificate.subjectOrganizationUnitName}}</span>
                </div>
              {{/if}}
              {{#if certificate.subjectSerialNumber}}
                <div>
                  <span class='p-key'>Subject Serial Number: </span>
                  <span class='p-value'>{{certificate.subjectSerialNumber}}</span>
                </div>
              {{/if}}
              {{#if certificate.subjectEmailAddress}}
                <div>
                  <span class='p-key'>Subject Email Address: </span>
                  <span class='p-value'>{{certificate.subjectEmailAddress}}</span>
                </div>
              {{/if}}
              {{#if certificate.subjectStreetAddress}}
                <div>
                  <span class='p-key'>Subject Street Address: </span>
                  <span class='p-value'>{{certificate.subjectStreetAddress}}</span>
                </div>
              {{/if}}
              {{#if certificate.subjectStateOrProvinceName}}
                <div>
                  <span class='p-key'>Subject State Or Province Name: </span>
                  <span class='p-value'>{{certificate.subjectStateOrProvinceName}}</span>
                </div>
              {{/if}}
              {{#if certificate.subjectCountry}}
                <div>
                  <span class='p-key'>Subject Country: </span>
                  <span class='p-value'>{{certificate.subjectCountry}}</span>
                </div>
              {{/if}}
            </div>
            <div class='mb-2'>
              <h1 class='p-title'>
                Issuer Cert Info
              </h1>
              {{#if certificate.issuerCommonName}}
                <div>
                  <span class='p-key'>Issuer Common Name: </span>
                  <span class='p-value'>{{certificate.issuerCommonName}}</span>
                </div>
              {{/if}}
              {{#if certificate.issuerGivenName}}
                <div>
                  <span class='p-key'>Issuer Given Name: </span>
                  <span class='p-value'>{{certificate.issuerGivenName}}</span>
                </div>
              {{/if}}
              {{#if certificate.issuerSurname}}
                <div>
                  <span class='p-key'>Issuer Surname: </span>
                  <span class='p-value'>{{certificate.issuerSurname}}</span>
                </div>
              {{/if}}
              {{#if certificate.issuerEmailAddress}}
                <div>
                  <span class='p-key'>Issuer Email Address: </span>
                  <span class='p-value'>{{certificate.issuerEmailAddress}}</span>
                </div>
              {{/if}}
              {{#if certificate.issuerOrganizationName}}
                <div>
                  <span class='p-key'>Issuer Organization Name: </span>
                  <span class='p-value'>{{certificate.issuerOrganizationName}}</span>
                </div>
              {{/if}}
              {{#if certificate.issuerOrganizationUnitName}}
                <div>
                  <span class='p-key'>Issuer Organization Unit Name: </span>
                  <span class='p-value'>{{certificate.issuerOrganizationUnitName}}</span>
                </div>
              {{/if}}
              {{#if certificate.issuerSerialNumber}}
                <div>
                  <span class='p-key'>Issuer Serial Number: </span>
                  <span class='p-value'>{{certificate.issuerSerialNumber}}</span>
                </div>
              {{/if}}
              {{#if certificate.issuerStreetAddress}}
                <div>
                  <span class='p-key'>Issuer Street Address: </span>
                  <span class='p-value'>{{certificate.issuerStreetAddress}}</span>
                </div>
              {{/if}}
              {{#if certificate.issuerStateOrProvinceName}}
                <div>
                  <span class='p-key'>Issuer State Or Province Name: </span>
                  <span class='p-value'>{{certificate.issuerStateOrProvinceName}}</span>
                </div>
              {{/if}}
              {{#if certificate.issuerLocalityName}}
                <div>
                  <span class='p-key'>Issuer Locality Name: </span>
                  <span class='p-value'>{{certificate.issuerLocalityName}}</span>
                </div>
              {{/if}}
              {{#if certificate.issuerCountry}}
                <div>
                  <span class='p-key'>Issuer Country: </span>
                  <span class='p-value'>{{certificate.issuerCountry}}</span>
                </div>
              {{/if}}
            </div>
          {{/each}}
        {{else}}
          <div class='alert alert-info mt-2' role='alert'>
            No SSL Certificates Details Found
          </div>
          <div>
            <span class='p-footnote mt-2'>Certificate searches only look for matches against the "subjectCommonName"
              field of the certificate</span>
          </div>
        {{/if}}
      {{/if}}
    {{/if}}

    {{#if (eq currentInfo 'reputation')}}
      {{#if (and block._state.searchRunning.reputation (not block._state.initialLoadAttempted.reputation))}}
        <div class='alert alert-info mt-2' role='alert'>
          {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
          Loading Reputation
        </div>
      {{else if (or
        details.reputation.isConnectionReset
        details.reputation.maxRequestQueueLimitHit
        details.reputation.isGatewayTimeout
        details.reputation.apiKeyLimitReached
        details.reputation.onMessageTimeout
      )}}
        {{#unless details.reputation.apiKeyLimitReached}}
          <button type='button' class='btn btn-polarity btn-sm retry-btn mt-1' {{action 'retrySearch' 'reputation'}}>
            {{#if block._state.searchRunning.reputation}}
              {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
            {{else}}
              Retry Reputation Search
            {{/if}}
          </button>
        {{/unless}}
        <div class='mt-1'>
          {{#if details.reputation.onMessageTimeout}}
            <span>The PassiveTotal API took too long to respond. You can retry your search by pressing the "Retry
              Reputation Search" button.</span>
            <div class='mt-1'>
              <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
                PassiveTotal Web Interface
                {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
            </div>
            <div>
              <span class='p-footnote'>Some searches via the PassiveTotal API take too long to respond. Click the link
                to run the search via the PassiveTotal website instead.</span>
            </div>
          {{else if details.reputation.apiKeyLimitReached}}
            <span>{{fa-icon icon='exclamation-circle' fixedWidth=true class='details-icon'}}
              You have reached your PassiveTotal API Search Quota. Please view your Search Quota below to determine when
              you will be able to run searches again.</span>
            <div class='mt-1'>
              <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
                PassiveTotal Web Interface
                {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
            </div>
            <div>
              <span class='p-footnote'>Use the link to run this search via the PassiveTotal website which uses a
                different quota.</span>
            </div>
            {{#if details.quota.user}}
              <div class='mt-1'>
                <div>
                  <span class='p-title'>{{fa-icon icon='user' fixedWidth=true}} Your User Search Quota</span>
                </div>
                <div>
                  <span class='p-key'>API Searches:</span>
                  <span class='p-value'>{{details.quota.user.licenseCounts.searchApi}}
                    of
                    {{details.quota.user.licenseLimits.searchApi}}
                    used</span>
                </div>
                <div>
                  <span class='p-key'>Quota Duration: </span>
                  <span class='p-value'>{{details.quota.user.quotaInterval}}</span>
                </div>
                <div>
                  <span class='p-key'>Next Quota Reset: </span>
                  <span class='p-value'>{{details.quota.user.next_reset}}</span>
                </div>
              </div>
            {{/if}}
            {{#if details.quota.organization}}
              <div class='mt-1'>
                <div>
                  <span class='p-title mt-0'>{{fa-icon icon='building' fixedWidth=true}}
                    Your Organization Search Quota</span>
                </div>
                <div>
                  <span class='p-key'>API Searches: </span>
                  <span class='p-value'>{{details.quota.organization.licenseCounts.enterprise.searchApi}}
                    of
                    {{details.quota.organization.licenseLimits.enterprise.searchApi}}
                    used</span>
                </div>
                <div>
                  <span class='p-key'>Quota Duration:</span>
                  <span>{{details.quota.organization.quotaInterval}}</span>
                </div>
                <div>
                  <span class='p-key'>Next Quota Reset: </span>
                  <span class='p-value'>{{details.quota.organization.next_reset}}</span>
                </div>
              </div>
            {{/if}}
          {{else}}
            <div class='mt-1'>
              <span>A temporary PassiveTotal API search limit was reached. You can retry your search by pressing the
                "Retry Reputation Search" button.</span>
            </div>
          {{/if}}
        </div>
      {{else}}
        {{#if details.reputation}}
          <h1 class='p-title'>
            {{fa-icon 'star' fixedWidth=true}}
            Reputation Details
          </h1>
          {{#if (or details.reputation.score (eq details.reputation.score 0))}}
            <div>
              <span class='p-key'>Score: </span>
              <span class='p-value'>{{details.reputation.score}}</span>
            </div>
          {{/if}}
          {{#if details.reputation.classification}}
            <div>
              <span class='p-key'>Classification: </span>
              <span class='p-value'><b>{{details.reputation.classification}}</b></span>
            </div>
          {{/if}}
          {{#each details.reputation.rules as |rule ruleIndex|}}
            {{#if (gt ruleIndex 0)}}
              <hr />
            {{/if}}
            <h1 class='p-title'>
              {{fa-icon 'check' fixedWidth=true}}
              Rule #{{inc ruleIndex}}
              Detail
            </h1>
            <div class='mb-2'>
              {{#if rule.link}}
                <div>
                  <span class='p-key'>Name: </span>
                  <span class='p-value'><a href='{{rule.link}}'>{{rule.name}}
                      {{fa-icon 'external-link-square' class='external-link-icon'}}</a></span>
                </div>
              {{else}}
                <div>
                  <span class='p-key'>Name: </span>
                  <span class='p-value'>{{rule.name}}</span>
                </div>
              {{/if}}
              {{#if rule.description}}
                <div>
                  <span class='p-key'>Description: </span>
                  <span class='p-value'>{{rule.description}}</span>
                </div>
              {{/if}}
              {{#if rule.severity}}
                <div>
                  <span class='p-key'>Severity: </span>
                  <span class='p-value'>{{rule.severity}}</span>
                </div>
              {{/if}}
            </div>
          {{/each}}
        {{else}}
          <div class='alert alert-info mt-2' role='alert'>
            No Reputation Details Found
          </div>
        {{/if}}
      {{/if}}
    {{/if}}

    {{#if (eq currentInfo 'malware')}}
      {{#if (and block._state.searchRunning.malware (not block._state.initialLoadAttempted.malware))}}
        <div class='alert alert-info mt-2' role='alert'>
          {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
          Loading Malware
        </div>
      {{else if (or
        details.malware.isConnectionReset
        details.malware.maxRequestQueueLimitHit
        details.malware.isGatewayTimeout
        details.malware.apiKeyLimitReached
        details.malware.onMessageTimeout
      )}}
        {{#unless details.malware.apiKeyLimitReached}}
          <button type='button' class='btn btn-polarity btn-sm retry-btn mt-1' {{action 'retrySearch' 'malware'}}>
            {{#if block._state.searchRunning.malware}}
              {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
            {{else}}
              Retry Malware Search
            {{/if}}
          </button>
        {{/unless}}
        <div class='mt-1'>
          {{#if details.malware.onMessageTimeout}}
            <span>The PassiveTotal API took too long to respond. You can retry your search by pressing the "Retry
              Malware Search" button.</span>
            <div class='mt-1'>
              <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
                PassiveTotal Web Interface
                {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
            </div>
            <div>
              <span class='p-footnote'>Some searches via the PassiveTotal API take too long to respond. Click the link
                to run the search via the PassiveTotal website instead.</span>
            </div>
          {{else if details.malware.apiKeyLimitReached}}
            <span>{{fa-icon icon='exclamation-circle' fixedWidth=true class='details-icon'}}
              You have reached your PassiveTotal API Search Quota. Please view your Search Quota below to determine when
              you will be able to run searches again.</span>
            <div class='mt-1'>
              <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
                PassiveTotal Web Interface
                {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
            </div>
            <div>
              <span class='p-footnote'>Use the link to run this search via the PassiveTotal website which uses a
                different quota.</span>
            </div>
            {{#if details.quota.user}}
              <div class='mt-1'>
                <div>
                  <span class='p-title'>{{fa-icon icon='user' fixedWidth=true}} Your User Search Quota</span>
                </div>
                <div>
                  <span class='p-key'>API Searches:</span>
                  <span class='p-value'>{{details.quota.user.licenseCounts.searchApi}}
                    of
                    {{details.quota.user.licenseLimits.searchApi}}
                    used</span>
                </div>
                <div>
                  <span class='p-key'>Quota Duration: </span>
                  <span class='p-value'>{{details.quota.user.quotaInterval}}</span>
                </div>
                <div>
                  <span class='p-key'>Next Quota Reset: </span>
                  <span class='p-value'>{{details.quota.user.next_reset}}</span>
                </div>
              </div>
            {{/if}}
            {{#if details.quota.organization}}
              <div class='mt-1'>
                <div>
                  <span class='p-title mt-0'>{{fa-icon icon='building' fixedWidth=true}}
                    Your Organization Search Quota</span>
                </div>
                <div>
                  <span class='p-key'>API Searches: </span>
                  <span class='p-value'>{{details.quota.organization.licenseCounts.enterprise.searchApi}}
                    of
                    {{details.quota.organization.licenseLimits.enterprise.searchApi}}
                    used</span>
                </div>
                <div>
                  <span class='p-key'>Quota Duration:</span>
                  <span>{{details.quota.organization.quotaInterval}}</span>
                </div>
                <div>
                  <span class='p-key'>Next Quota Reset: </span>
                  <span class='p-value'>{{details.quota.organization.next_reset}}</span>
                </div>
              </div>
            {{/if}}
          {{else}}
            <div class='mt-1'>
              <span>A temporary PassiveTotal API search limit was reached. You can retry your search by pressing the
                "Retry Malware Search" button.</span>
            </div>
          {{/if}}
        </div>
      {{else}}
        {{#if details.malware}}
          <h1 class='p-title'>
            {{fa-icon 'bug' fixedWidth=true}}
            Malware Details
          </h1>
          {{#each details.malware as |result resultIndex|}}
            <div class='mb-2'>
              <div>
                <span class='p-key'>Sample: </span>
                <span class='p-value'><a
                    href='https://www.virustotal.com/gui/search/{{{result.sample}}}'
                  >{{{result.sample}}} (VT) {{fa-icon 'external-link-square' class='external-link-icon'}}</a></span>
              </div>
              <div>
                <span class='p-key'>Collection Date: </span>
                <span class='p-value'>{{result.collectionDate}}</span>
              </div>
              <div>
                <span class='p-key'>Source: </span>
                <span class='p-value'><a href='{{{result.sourceUrl}}}'>{{{result.source}}}
                    {{fa-icon 'external-link-square' class='external-link-icon'}}</a></span>
              </div>
            </div>
          {{/each}}
        {{else}}
          <div class='alert alert-info mt-2' role='alert'>
            No Malware Details Found
          </div>
        {{/if}}
      {{/if}}
    {{/if}}
  {{/if}}

  {{#if (eq currentInfo 'summary')}}
    <h1 class='p-title'>
      {{fa-icon 'id-card' fixedWidth=true}}
      Summary Card Details
    </h1>

    {{#if summary.name}}
      <div>
        <span class='p-key'>Name: </span>
        <span class='p-value'><a href='{{summary.link}}'>{{summary.name}}
            {{fa-icon 'external-link-square' class='external-link-icon'}}</a></span>
      </div>
    {{/if}}
    {{#if summary.type}}
      <div>
        <span class='p-key'>Type: </span>
        <span class='p-value'>{{summary.type}}</span>
      </div>
    {{/if}}
    {{#if summary.netblock}}
      {{#if (not-eq summary.netblock 'n/a')}}
        <div>
          <span class='p-key'>Netblock: </span>
          <span class='p-value'>{{summary.netblock}}</span>
        </div>
      {{/if}}
    {{/if}}
    {{#if summary.os}}
      {{#if (not-eq summary.os 'n/a')}}
        <div>
          <span class='p-key'>OS: </span>
          <span class='p-value'>{{summary.os}}</span>
        </div>
      {{/if}}
    {{/if}}
    {{#if summary.asn}}
      {{#if (not-eq summary.asn 'n/a')}}
        <div>
          <span class='p-key'>ASN: </span>
          <span class='p-value'>{{summary.asn}}</span>
        </div>
      {{/if}}
    {{/if}}
    {{#if summary.hosting_provider}}
      {{#if (not-eq summary.hosting_provider 'n/a')}}
        <div>
          <span class='p-key'>Hosting Provider: </span>
          <span class='p-value'>{{summary.hosting_provider}}</span>
        </div>
      {{/if}}
    {{/if}}
    {{#if summary.data_summary.resolutions}}
      {{#if (gt summary.data_summary.resolutions.count 0)}}
        <div>
          <span class='p-key'>Resolutions: </span>
          <span class='p-value'><a
              href='{{summary.data_summary.resolutions.link}}'
            >{{summary.data_summary.resolutions.count}}
              {{fa-icon 'external-link-square' class='external-link-icon'}}</a></span>
        </div>
      {{/if}}
    {{/if}}
    {{#if summary.data_summary.certificates}}
      {{#if (gt summary.data_summary.certificates.count 0)}}
        <div>
          <span class='p-key'>Certificates: </span>
          <span class='p-value'><a
              href='{{summary.data_summary.certificates.link}}'
            >{{summary.data_summary.certificates.count}}
              {{fa-icon 'external-link-square' class='external-link-icon'}}</a></span>
        </div>
      {{/if}}
    {{/if}}
    {{#if summary.data_summary.hashes}}
      {{#if (gt summary.data_summary.hashes.count 0)}}
        <div>
          <span class='p-key'>Hashes: </span>
          <span class='p-value'><a href='{{summary.data_summary.hashes.link}}'>{{summary.data_summary.hashes.count}}
              {{fa-icon 'external-link-square' class='external-link-icon'}}</a></span>
        </div>
      {{/if}}
    {{/if}}
    {{#if summary.data_summary.projects}}
      {{#if (gt summary.data_summary.projects.count 0)}}
        <div>
          <span class='p-key'>Projects: </span>
          <span class='p-value'><a href='{{summary.data_summary.projects.link}}'>{{summary.data_summary.projects.count}}
              {{fa-icon 'external-link-square' class='external-link-icon'}}</a></span>
        </div>
      {{/if}}
    {{/if}}
    {{#if summary.data_summary.articles}}
      {{#if (gt summary.data_summary.articles.count 0)}}
        <div>
          <span class='p-key'>Articles: </span>
          <span class='p-value'><a href='{{summary.data_summary.articles.link}}'>{{summary.data_summary.articles.count}}
              {{fa-icon 'external-link-square' class='external-link-icon'}}</a></span>
        </div>
      {{/if}}
    {{/if}}
    {{#if summary.data_summary.trackers}}
      {{#if (gt summary.data_summary.trackers.count 0)}}
        <div>
          <span class='p-key'>Trackers: </span>
          <span class='p-value'><a href='{{summary.data_summary.trackers.link}}'>{{summary.data_summary.trackers.count}}
              {{fa-icon 'external-link-square' class='external-link-icon'}}</a></span>
        </div>
      {{/if}}
    {{/if}}
    {{#if summary.data_summary.components}}
      {{#if (gt summary.data_summary.components.count 0)}}
        <div>
          <span class='p-key'>Components: </span>
          <span class='p-value'><a
              href='{{summary.data_summary.components.link}}'
            >{{summary.data_summary.components.count}}
              {{fa-icon 'external-link-square' class='external-link-icon'}}</a></span>
        </div>
      {{/if}}
    {{/if}}
    {{#if summary.data_summary.host_pairs}}
      {{#if (gt summary.data_summary.host_pairs.count 0)}}
        <div>
          <span class='p-key'>Host Pairs: </span>
          <span class='p-value'><a
              href='{{summary.data_summary.host_pairs.link}}'
            >{{summary.data_summary.host_pairs.count}}
              {{fa-icon 'external-link-square' class='external-link-icon'}}</a></span>
        </div>
      {{/if}}
    {{/if}}
    {{#if summary.data_summary.cookies}}
      {{#if (gt summary.data_summary.cookies.count 0)}}
        <div>
          <span class='p-key'>Cookies: </span>
          <span class='p-value'><a href='{{summary.data_summary.cookies.link}}'>{{summary.data_summary.cookies.count}}
              {{fa-icon 'external-link-square' class='external-link-icon'}}</a></span>
        </div>
      {{/if}}
    {{/if}}
    {{! view quota }}
    <div class='mt-1'>
      <span class='p-action' {{action 'showQuota'}}>
        {{#if block._state.viewQuota}}
          Hide Search Quota
          {{fa-icon icon='chevron-up'}}
        {{else}}
          View Search Quota
          {{fa-icon icon='chevron-down'}}
        {{/if}}
      </span>
      {{#if block._state.searchRunning.quota}}
        <div class='mt-1'>
          {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
          Loading Quota ...
        </div>
      {{/if}}
      {{#if block._state.viewQuota}}
        {{#if details.quota}}
          <div class='quota-container mt-1'>
            {{#if details.quota.user}}
              <div>
                <div>
                  <span class='p-title mt-0'>{{fa-icon icon='user' fixedWidth=true}} Your User Search Quota</span>
                </div>
                <div>
                  <span class='p-key'>API Searches:</span>
                  <span class='p-value'>{{details.quota.user.licenseCounts.searchApi}}
                    of
                    {{details.quota.user.licenseLimits.searchApi}}
                    used</span>
                </div>
                <div>
                  <span class='p-key'>Quota Duration: </span>
                  <span class='p-value'>{{details.quota.user.quotaInterval}}</span>
                </div>
                <div>
                  <span class='p-key'>Next Quota Reset: </span>
                  <span class='p-value'>{{details.quota.user.next_reset}}</span>
                </div>
              </div>
            {{/if}}
            {{#if details.quota.organization}}
              <div class='mt-1'>
                <div>
                  <span class='p-title mt-0'>{{fa-icon icon='building' fixedWidth=true}}
                    Your Organization Search Quota</span>
                </div>
                <div>
                  <span class='p-key'>API Searches: </span>
                  <span class='p-value'>{{details.quota.organization.licenseCounts.enterprise.searchApi}}
                    of
                    {{details.quota.organization.licenseLimits.enterprise.searchApi}}
                    used</span>
                </div>
                <div>
                  <span class='p-key'>Quota Duration:</span>
                  <span>{{details.quota.organization.quotaInterval}}</span>
                </div>
                <div>
                  <span class='p-key'>Next Quota Reset: </span>
                  <span class='p-value'>{{details.quota.organization.next_reset}}</span>
                </div>
              </div>
            {{/if}}
            <span class='reload-quota-btn' {{action 'getQuota'}}>
              {{fa-icon
                icon='sync'
                fixedWidth=true
                class='icon'
                title='Refresh Quota'
                spin=(if block._state.searchRunning.quota true false)
              }}
            </span>
          </div>
        {{/if}}
      {{/if}}
    </div>
  {{/if}}
{{/if}}

{{#if (eq block.entity.type 'custom')}}
  {{! Tracker output parsing}}
  <div class='view-in-pt'>
    <a href='https://community.riskiq.com/search/trackers/{{block.entity.value}}'>View in PassiveTotal
      {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
  </div>
  <h1 class='p-title'>
    {{fa-icon 'code' fixedWidth=true}}
    Google Analytics Tracker Details
  </h1>
  {{#each details.tracker as |result index|}}
    <div class='mb-2'>
      <div>
        <span class='p-key'>Entity: </span>
        <a href='https://community.riskiq.com/search/{{result.entity}}'>{{result.entity}}
          {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
      </div>
      <div>
        <span class='p-key'>First Seen: </span>
        <span class='p-value'>{{result.firstSeen}}</span>
      </div>
      <div>
        <span class='p-key'>Last Seen: </span>
        <span class='p-value'>{{result.lastSeen}}</span>
      </div>
    </div>
  {{/each}}
  {{! view quota }}
  <div class='mt-1'>
    <span class='p-action' {{action 'showQuota'}}>
      {{#if block._state.viewQuota}}
        Hide Search Quota
        {{fa-icon icon='chevron-up'}}
      {{else}}
        View Search Quota
        {{fa-icon icon='chevron-down'}}
      {{/if}}
    </span>
    {{#if block._state.searchRunning.quota}}
      <div class='mt-1'>
        {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
        Loading Quota ...
      </div>
    {{/if}}
    {{#if block._state.viewQuota}}
      {{#if details.quota}}
        <div class='quota-container mt-1'>
          {{#if details.quota.user}}
            <div>
              <div>
                <span class='p-title mt-0'>{{fa-icon icon='user' fixedWidth=true}} Your User Search Quota</span>
              </div>
              <div>
                <span class='p-key'>API Searches:</span>
                <span class='p-value'>{{details.quota.user.licenseCounts.searchApi}}
                  of
                  {{details.quota.user.licenseLimits.searchApi}}
                  used</span>
              </div>
              <div>
                <span class='p-key'>Quota Duration: </span>
                <span class='p-value'>{{details.quota.user.quotaInterval}}</span>
              </div>
              <div>
                <span class='p-key'>Next Quota Reset: </span>
                <span class='p-value'>{{details.quota.user.next_reset}}</span>
              </div>
            </div>
          {{/if}}
          {{#if details.quota.organization}}
            <div class='mt-1'>
              <div>
                <span class='p-title mt-0'>{{fa-icon icon='building' fixedWidth=true}}
                  Your Organization Search Quota</span>
              </div>
              <div>
                <span class='p-key'>API Searches: </span>
                <span class='p-value'>{{details.quota.organization.licenseCounts.enterprise.searchApi}}
                  of
                  {{details.quota.organization.licenseLimits.enterprise.searchApi}}
                  used</span>
              </div>
              <div>
                <span class='p-key'>Quota Duration:</span>
                <span>{{details.quota.organization.quotaInterval}}</span>
              </div>
              <div>
                <span class='p-key'>Next Quota Reset: </span>
                <span class='p-value'>{{details.quota.organization.next_reset}}</span>
              </div>
            </div>
          {{/if}}
          <span class='reload-quota-btn' {{action 'getQuota'}}>
            {{fa-icon
              icon='sync'
              fixedWidth=true
              class='icon'
              title='Refresh Quota'
              spin=(if block._state.searchRunning.quota true false)
            }}
          </span>
        </div>
      {{/if}}
    {{/if}}
  </div>
{{/if}}

{{#if (eq currentInfo 'osint')}}
  {{#if (and block._state.searchRunning.osint.osintData (not block._state.initialLoadAttempted.osint.osintData))}}
    <div class='alert alert-info mt-2' role='alert'>
      {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
      Loading OSINT
    </div>
  {{else if (or
    details.osint.isConnectionReset
    details.osint.maxRequestQueueLimitHit
    details.osint.isGatewayTimeout
    details.osint.apiKeyLimitReached
    details.osint.onMessageTimeout
  )}}
    {{#unless details.osint.apiKeyLimitReached}}
      <button type='button' class='btn btn-polarity btn-sm retry-btn mt-1' {{action 'retrySearch' 'osint'}}>
        {{#if block._state.searchRunning.osint}}
          {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
        {{else}}
          Retry osint.osintData Search
        {{/if}}
      </button>
    {{/unless}}
    <div class='mt-1'>
      {{#if details.osint.onMessageTimeout}}
        <span>The PassiveTotal API took too long to respond. You can retry your search by pressing the "Retry OSINT
          Search" button.</span>
        <div class='mt-1'>
          <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
            PassiveTotal Web Interface
            {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
        </div>
        <div>
          <span class='p-footnote'>Some searches via the PassiveTotal API take too long to respond. Click the link to
            run the search via the PassiveTotal website instead.</span>
        </div>
      {{else if details.osint.apiKeyLimitReached}}
        <span>{{fa-icon icon='exclamation-circle' fixedWidth=true class='details-icon'}}
          You have reached your PassiveTotal API Search Quota. Please view your Search Quota below to determine when you
          will be able to run searches again.</span>
        <div class='mt-1'>
          <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
            PassiveTotal Web Interface
            {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
        </div>
        <div>
          <span class='p-footnote'>Use the link to run this search via the PassiveTotal website which uses a different
            quota.</span>
        </div>
        {{#if details.quota.user}}
          <div class='mt-1'>
            <div>
              <span class='p-title'>{{fa-icon icon='user' fixedWidth=true}} Your User Search Quota</span>
            </div>
            <div>
              <span class='p-key'>API Searches:</span>
              <span class='p-value'>{{details.quota.user.licenseCounts.searchApi}}
                of
                {{details.quota.user.licenseLimits.searchApi}}
                used</span>
            </div>
            <div>
              <span class='p-key'>Quota Duration: </span>
              <span class='p-value'>{{details.quota.user.quotaInterval}}</span>
            </div>
            <div>
              <span class='p-key'>Next Quota Reset: </span>
              <span class='p-value'>{{details.quota.user.next_reset}}</span>
            </div>
          </div>
        {{/if}}
        {{#if details.quota.organization}}
          <div class='mt-1'>
            <div>
              <span class='p-title mt-0'>{{fa-icon icon='building' fixedWidth=true}}
                Your Organization Search Quota</span>
            </div>
            <div>
              <span class='p-key'>API Searches: </span>
              <span class='p-value'>{{details.quota.organization.licenseCounts.enterprise.searchApi}}
                of
                {{details.quota.organization.licenseLimits.enterprise.searchApi}}
                used</span>
            </div>
            <div>
              <span class='p-key'>Quota Duration:</span>
              <span>{{details.quota.organization.quotaInterval}}</span>
            </div>
            <div>
              <span class='p-key'>Next Quota Reset: </span>
              <span class='p-value'>{{details.quota.organization.next_reset}}</span>
            </div>
          </div>
        {{/if}}
      {{else}}
        <div class='mt-1'>
          <span>A temporary PassiveTotal API search limit was reached. You can retry your search by pressing the "Retry
            OSINT Search" button.</span>
        </div>
      {{/if}}
    </div>
  {{else}}
    {{#if details.osint.osintData}}
      <div class='osint-container'>
        <h1 class='p-title'>
          {{fa-icon 'search' fixedWidth=true}}
          OSINT Details
        </h1>
        {{#each details.osint.osintData as |info|}}
          <div class='mb-3'>
            {{#if info.source}}
              <div>
                <span class='p-key'>Source: </span>
                <span class='p-value'>{{info.source}}</span>
              </div>
            {{/if}}
            {{#if info.sourceUrl}}
              <div>
                <span class='p-key'>Source URL: </span>
                <span class='p-value'>{{info.sourceUrl}}</span>
              </div>
            {{/if}}
            {{#if info.tags.length}}
              <div>
                <span class='p-key'>Tags: </span>
                {{#each info.tags as |tag|}}
                  <div class='tag-value'>
                    <span class='tag'>{{tag}}</span>
                  </div>
                {{/each}}
              </div>
            {{/if}}
          </div>
        {{/each}}
      </div>
    {{else}}
      <div class='alert alert-info mt-2' role='alert'>
        No OSINT Details Found
      </div>
    {{/if}}
  {{/if}}
{{/if}}

{{#if (eq currentInfo 'services')}}
  {{#if (and block._state.searchRunning.services (not block._state.initialLoadAttempted.services))}}
    <div class='alert alert-info mt-2' role='alert'>
      {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
      Loading Services
    </div>
  {{else if (or
    details.services.isConnectionReset
    details.services.maxRequestQueueLimitHit
    details.services.isGatewayTimeout
    details.services.apiKeyLimitReached
  )}}
    {{#unless details.services.apiKeyLimitReached}}
      <button type='button' class='btn btn-polarity btn-sm retry-btn mt-1' {{action 'retrySearch' 'services'}}>
        {{#if block._state.searchRunning.services}}
          {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
        {{else}}
          Retry Services Search
        {{/if}}
      </button>
    {{/unless}}
    <div class='mt-1'>
      {{#if details.services.onMessageTimeout}}
        <span>The PassiveTotal API took too long to respond. You can retry your search by pressing the "Retry services
          Search" button.</span>
        <div class='mt-1'>
          <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
            PassiveTotal Web Interface
            {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
        </div>
        <div>
          <span class='p-footnote'>Some searches via the PassiveTotal API take too long to respond. Click the link to
            run the search via the PassiveTotal website instead.</span>
        </div>
      {{else if details.services.apiKeyLimitReached}}
        <span>{{fa-icon icon='exclamation-circle' fixedWidth=true class='details-icon'}}
          You have reached your PassiveTotal API Search Quota. Please view your Search Quota below to determine when you
          will be able to run searches again.</span>
        <div class='mt-1'>
          <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
            PassiveTotal Web Interface
            {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
        </div>
        <div>
          <span class='p-footnote'>Use the link to run this search via the PassiveTotal website which uses a different
            quota.</span>
        </div>
        {{#if details.quota.user}}
          <div class='mt-1'>
            <div>
              <span class='p-title'>{{fa-icon icon='user' fixedWidth=true}} Your User Search Quota</span>
            </div>
            <div>
              <span class='p-key'>API Searches:</span>
              <span class='p-value'>{{details.quota.user.licenseCounts.searchApi}}
                of
                {{details.quota.user.licenseLimits.searchApi}}
                used</span>
            </div>
            <div>
              <span class='p-key'>Quota Duration: </span>
              <span class='p-value'>{{details.quota.user.quotaInterval}}</span>
            </div>
            <div>
              <span class='p-key'>Next Quota Reset: </span>
              <span class='p-value'>{{details.quota.user.next_reset}}</span>
            </div>
          </div>
        {{/if}}
        {{#if details.quota.organization}}
          <div class='mt-1'>
            <div>
              <span class='p-title mt-0'>{{fa-icon icon='building' fixedWidth=true}}
                Your Organization Search Quota</span>
            </div>
            <div>
              <span class='p-key'>API Searches: </span>
              <span class='p-value'>{{details.quota.organization.licenseCounts.enterprise.searchApi}}
                of
                {{details.quota.organization.licenseLimits.enterprise.searchApi}}
                used</span>
            </div>
            <div>
              <span class='p-key'>Quota Duration:</span>
              <span>{{details.quota.organization.quotaInterval}}</span>
            </div>
            <div>
              <span class='p-key'>Next Quota Reset: </span>
              <span class='p-value'>{{details.quota.organization.next_reset}}</span>
            </div>
          </div>
        {{/if}}
      {{else}}
        <div class='mt-1'>
          <span>A temporary PassiveTotal API search limit was reached. You can retry your search by pressing the "Retry
            services Search" button.</span>
        </div>
      {{/if}}
    </div>
  {{else}}
    {{#if details.services.servicesData}}
      <div class='mb-2'>
        <h1 class='p-title'>
          {{fa-icon 'network-wired' fixedWidth=true}}
          Service Details
        </h1>

        {{#each details.services.servicesData as |service index|}}
          {{#if (gt index 0)}}
            <hr />
          {{/if}}
          {{#if service.portNumber}}
            <div>
              <span class='p-key'>Port Number: </span>
              <span class='p-value'>{{service.portNumber}}</span>
            </div>
          {{/if}}
          {{#if service.status}}
            <div>
              <span class='p-key'>Status: </span>
              <span class='p-value'>{{service.status}}</span>
            </div>
          {{/if}}
          {{#if service.protocol}}
            <div>
              <span class='p-key'>Protocol: </span>
              <span class='p-value'>{{service.protocol}}</span>
            </div>
          {{/if}}

          {{! Current Services}}
          {{#if (get currentServiceStates index)}}
            <a href='#' class='expandable-title' {{on 'click' (action 'toggleExpandableCurrentServiceTitle' index)}}>
              <span class='text'><span class='desc'>Current Services:</span> {{UNIQUE_VALUE}}</span>
              {{fa-icon 'angle-up'}}
            </a>
            {{#each service.currentServices as |currentService index|}}
              <div class='current-service-information'>
                {{#if currentService.label}}
                  <div>
                    <span class='p-key'>Label: </span>
                    <span class='p-value'>{{currentService.label}}</span>
                  </div>
                {{/if}}
                {{#if currentService.category}}
                  <div>
                    <span class='p-key'>Category: </span>
                    <span class='p-value'>{{currentService.category}}</span>
                  </div>
                {{/if}}
                {{#if currentService.version}}
                  <div>
                    <span class='p-key'>Version: </span>
                    <span class='p-value'>{{currentService.version}}</span>
                  </div>
                {{/if}}
                {{#if currentService.firstSeen}}
                  <div>
                    <span class='p-key'>First Seen: </span>
                    <span class='p-value'>{{moment-format
                        currentService.firstSeen
                        'MM/DD/YYYY HH:mm:ss'
                        timeZone=timezone
                      }}</span>
                  </div>
                {{/if}}
                {{#if currentService.lastSeen}}
                  <div>
                    <span class='p-key'>First Seen: </span>
                    <span class='p-value'>{{moment-format
                        currentService.lastSeen
                        'MM/DD/YYYY HH:mm:ss'
                        timeZone=timezone
                      }}</span>
                  </div>
                {{/if}}
              </div>
            {{/each}}
          {{else}}
            <a href='#' class='expandable-title' {{on 'click' (action 'toggleExpandableCurrentServiceTitle' index)}}>
              <span class='text'>Current Services</span>
              {{fa-icon 'angle-down'}}
            </a>
          {{/if}}

          {{! Recent Services}}
          {{#if (get recentServiceStates index)}}
            <a href='#' class='expandable-title' {{on 'click' (action 'toggleExpandableRecentServiceTitle' index)}}>
              <span class='text'><span class='desc'>Recent Services:</span> {{UNIQUE_VALUE}}</span>
              {{fa-icon 'angle-up'}}
            </a>
            {{#each service.recentServices as |recentService index|}}
              <div class='recent-service-information'>
                {{#if recentService.label}}
                  <div>
                    <span class='p-key'>Label: </span>
                    <span class='p-value'>{{recentService.label}}</span>
                  </div>
                {{/if}}
                {{#if recentService.category}}
                  <div>
                    <span class='p-key'>Category: </span>
                    <span class='p-value'>{{recentService.category}}</span>
                  </div>
                {{/if}}
                {{#if recentService.version}}
                  <div>
                    <span class='p-key'>Version: </span>
                    <span class='p-value'>{{recentService.version}}</span>
                  </div>
                {{/if}}
                {{#if recentService.firstSeen}}
                  <div>
                    <span class='p-key'>First Seen: </span>
                    <span class='p-value'>{{moment-format
                        recentService.firstSeen
                        'MM/DD/YYYY HH:mm:ss'
                        timeZone=timezone
                      }}</span>
                  </div>
                {{/if}}
                {{#if recentService.lastSeen}}
                  <div>
                    <span class='p-key'>First Seen: </span>
                    <span class='p-value'>{{moment-format
                        recentService.lastSeen
                        'MM/DD/YYYY HH:mm:ss'
                        timeZone=timezone
                      }}</span>
                  </div>
                {{/if}}
              </div>
            {{/each}}
          {{else}}
            <a href='#' class='expandable-title' {{on 'click' (action 'toggleExpandableRecentServiceTitle' index)}}>
              <span class='text'>Recent Services</span>
              {{fa-icon 'angle-down'}}
            </a>
          {{/if}}
        {{/each}}
      </div>
    {{else}}
      <div class='alert alert-info mt-2' role='alert'>
        No Service Details Found
      </div>
    {{/if}}
  {{/if}}
{{/if}}

{{#if (eq currentInfo 'subdomains')}}
  {{#if (and block._state.searchRunning.subdomains (not block._state.initialLoadAttempted.subdomains))}}
    <div class='alert alert-info mt-2' role='alert'>
      {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
      Loading Resolution/subdomains
    </div>
  {{else if (or
    details.subdomains.isConnectionReset
    details.subdomains.maxRequestQueueLimitHit
    details.subdomains.isGatewayTimeout
    details.subdomains.apiKeyLimitReached
    details.subdomains.onMessageTimeout
  )}}
    {{#unless details.subdomains.apiKeyLimitReached}}
      <button type='button' class='btn btn-polarity btn-sm retry-btn mt-1' {{action 'retrySearch' 'subdomains'}}>
        {{#if block._state.searchRunning.subdomains}}
          {{fa-icon icon='spinner-third' fixedWidth=true spin=true}}
        {{else}}
          Retry subdomains Search
        {{/if}}
      </button>
    {{/unless}}
    <div class='mt-1'>
      {{#if details.subdomains.onMessageTimeout}}
        <span>The PassiveTotal API took too long to respond. You can retry your search by pressing the "Retry subdomains
          Search" button.</span>
        <div class='mt-1'>
          <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
            PassiveTotal Web Interface
            {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
        </div>
        <div>
          <span class='p-footnote'>Some searches via the PassiveTotal API take too long to respond. Click the link to
            run the search via the PassiveTotal website instead.</span>
        </div>
      {{else if details.subdomains.apiKeyLimitReached}}
        <span>{{fa-icon icon='exclamation-circle' fixedWidth=true class='details-icon'}}
          You have reached your PassiveTotal API Search Quota. Please view your Search Quota below to determine when you
          will be able to run searches again.</span>
        <div class='mt-1'>
          <a class='p-link' href='https://community.riskiq.com/research?query={{block.entity.value}}'>Run Search via
            PassiveTotal Web Interface
            {{fa-icon 'external-link-square' class='external-link-icon'}}</a>
        </div>
        <div>
          <span class='p-footnote'>Use the link to run this search via the PassiveTotal website which uses a different
            quota.</span>
        </div>
        {{#if details.quota.user}}
          <div class='mt-1'>
            <div>
              <span class='p-title'>{{fa-icon icon='user' fixedWidth=true}} Your User Search Quota</span>
            </div>
            <div>
              <span class='p-key'>API Searches:</span>
              <span class='p-value'>{{details.quota.user.licenseCounts.searchApi}}
                of
                {{details.quota.user.licenseLimits.searchApi}}
                used</span>
            </div>
            <div>
              <span class='p-key'>Quota Duration: </span>
              <span class='p-value'>{{details.quota.user.quotaInterval}}</span>
            </div>
            <div>
              <span class='p-key'>Next Quota Reset: </span>
              <span class='p-value'>{{details.quota.user.next_reset}}</span>
            </div>
          </div>
        {{/if}}
        {{#if details.quota.organization}}
          <div class='mt-1'>
            <div>
              <span class='p-title mt-0'>{{fa-icon icon='building' fixedWidth=true}}
                Your Organization Search Quota</span>
            </div>
            <div>
              <span class='p-key'>API Searches: </span>
              <span class='p-value'>{{details.quota.organization.licenseCounts.enterprise.searchApi}}
                of
                {{details.quota.organization.licenseLimits.enterprise.searchApi}}
                used</span>
            </div>
            <div>
              <span class='p-key'>Quota Duration:</span>
              <span>{{details.quota.organization.quotaInterval}}</span>
            </div>
            <div>
              <span class='p-key'>Next Quota Reset: </span>
              <span class='p-value'>{{details.quota.organization.next_reset}}</span>
            </div>
          </div>
        {{/if}}
      {{else}}
        <div class='mt-1'>
          <span>A temporary PassiveTotal API search limit was reached. You can retry your search by pressing the "Retry
            subdomains Search" button.</span>
        </div>
      {{/if}}
    </div>
  {{else}}
    {{#if details.subdomains}}
      <h1 class='p-title'>
        {{fa-icon 'ethernet' fixedWidth=true}}
        Subdomains
      </h1>

      <div>
        <span class='p-key'>Primary Domain: </span>
        <span class='p-value'>{{details.subdomains.primaryDomain}}</span>
      </div>

      <div>
        <span class='p-key'>Query Value: </span>
        <span class='p-value'>{{details.subdomains.queryValue}}</span>
      </div>

      <div class='subdomain-info'>
        {{#each details.subdomains.subdomains as |subdomain index|}}
          {{#if (get subdomainStates index)}}
            <a href='#' class='expandable-title' {{on 'click' (action 'toggleExpandableSubdomains' index)}}>
              <span class='text'><span class='desc'>Subdomains:</span> {{UNIQUE_VALUE}}</span>
              {{fa-icon 'angle-up'}}
            </a>
            <div>
              <span class='p-value'>{{subdomain}}</span>
            </div>
          {{else}}
            <a href='#' class='expandable-title' {{on 'click' (action 'toggleExpandableSubdomains' index)}}>
              <span class='text'>Subdomains</span>
              {{fa-icon 'angle-down'}}
            </a>
          {{/if}}
        {{/each}}
      </div>
    {{else}}
      <div class='alert alert-info mt-2' role='alert'>
        No Subdomains Found
      </div>
    {{/if}}
  {{/if}}
{{/if}}